#include <bits/stdc++.h>
using namespace std;
#define int long long
const long long INF=9e18;
const int inf=2e9;
const long double EPS=1e-12;
const long double PI=3.141;
vector<int> h, t, ans;
int answer=INF;
vector<vector<int>> g;
void dfs(int p, int v){
	if(t[v]==1)h[v]=0;
	for(auto to: g[v]){
		if(to!=p){
			dfs(v,to);
			if(h[to]!=-1)h[v]=max(h[to]+1,h[v]);	
		}
	}
}
void dfs2(int p, int v, int s){
	set<pair<int,int>> q;
	q.insert({s-1,-1});
	for(auto to: g[v]){
                if(to!=p){
			q.insert({h[to],to});
		}
	}
	s=max(s,h[v]);
	answer=min(answer,s);
	for(auto to: g[v]){
                if(to!=p){
			if(s>0){
				if(to!=(*(--q.end())).second){
					dfs2(v,to,s+1);
				}else{
					dfs2(v,to,(*(--(--q.end()))).first+2);
				}
			}else{
				dfs2(v,to,t[v]);
			}
		}
	}
}
void solve(){
	int n, x, y;
	cin>>n;
	h.resize(n,-1);
	t.resize(n);
	g.resize(n,vector<int>(0));
	for(int i=0;i<n;i++)cin>>t[i];
	for(int i=0;i<n-1;i++){
		cin>>x>>y;
		x--;y--;
		g[x].push_back(y);
		g[y].push_back(x);
	}
	dfs(-1,0);
	dfs2(-1,0, 0);		
	cout<<answer;		
}
signed main(){
	ios_base::sync_with_stdio(0);
	cin.tie(0);
	cout.tie(0);
	int t=1;
	//cin>>t;
	while(t--){                                                                       
		solve();
	}
	return 0;
}
